<style>
      #guide #profile {margin: 50px;}
      #guide #edit-profile {max-width: 820px !important}
      #guide #edit-profile a {color: #ffffff;}
      #guide #profile #edit-profile #image-upload {width: 100%;}
      #guide .ballot-section {width: 840px; float: left; margin: 40px auto 20px;}
      #guide .ballot-section.half {width: 420px;}
      #guide .ballot-section .sectionheading {font-size: 16px;}
      #guide .ballot-section .sectionheading a {color: #ffffff;}
      #guide .ballot-section .sectionheading:before {content: "";}
      #guide .input {float: left; text-align: left; width: 60%;}
      #guide .blurb {float: right; text-align: left; width: 60%; margin-right: 20px; font-size: 14px;}
      #guide input[type="text"], #guide select, #guide textarea {width: 60%; font-size: 16px; display: inline-block; margin: 0px 0px 10px 0px; border-radius: 4px; background-clip: padding-box; padding: 5px; outline: none; box-shadow: inset 0 0px 4px 0 rgba(0, 0, 0, 0.25); border: 1px solid #c2c2b5; color: #5b5b5b;}
      #guide input[type="checkbox"] {width: auto !important;}
      #guide label {display: inline-block; float: left; text-align: right; margin-right: 30px; width: 33%; color: #ffffff;}
      #guide input[type="submit"] {margin: 0px auto !important;} 
      #guide select {margin-left: 7px;}
      #guide .mce-tinymce {margin-top: 10px;}
      #guide .comments {width: 90%; margin: 0px auto;}
      #guide td {padding: 10px;}
</style>

<%
  contests = Hash.new
  @choices.each do |contest|
    contests[contest.id] = contest.contest
  end

  options = Hash.new
  contests_options = Hash.new
  @options.each do |option|
    options[option.id] = option.name 
    contests_options[option.id] = option.choice_id
  end
  
  user_option_ids = Hash.new
  contests_writeins = Hash.new
  @writeins.each do |writein|
    user_option_ids[writein.id] = writein.name
    contests_writeins[writein.id] = contests[writein.choice_id]
  end
%>


<div id="guide">
  <h1>
  <% if @guide.name.nil? %>
    <%= t('guide.guide_no') %>
    <%= @guide.id %>
  <% else %>
    <%= @guide.name %>
  <% end %>
  </h1>

  <div id="sortable">
    <% @blocks.each do |block| %>
      <% 
        halfwidth = ''
        if !block.full_size.nil? and !block.full_size
          halfwidth = ' half'
        end

        if block.option_id.nil? and !block.user_option_id.nil?
          contest_name = contests_writeins[block.user_option_id]
          subtitle = user_option_ids[block.user_option_id]
        elsif !block.option_id.nil?
          contest_name = contests[contests_options[block.option_id]]
          subtitle = options[block.option_id]
        elsif !block.title.nil?
          contest_name = block.title.html_safe
          subtitle = false
        end
      %>

      <div class="ballot-section<%= halfwidth %>">
        <div class="sectionheading">
          <h1 style="background: #D37A3C; padding: 10px;"><%= contest_name %></h1><br>
          <% if subtitle %>
            <h2 class="writein_name"><%= subtitle %></h2><br>
          <% end %>

          <% if !block.content.nil? %>
            <p style="text-align: left; padding: 0 40px;"><%= block.content.html_safe %></p>
          <% end %>

        </div>
      </div>
    <% end %>

    <div style="clear: both; float: none;"></div>
  </div>

  <div style="clear: both; float: none;"></div>

  <%= link_to t("site.back"), profile_path(@user), :class => 'button' %>
</div>

<script>
  function expand(id) {
    if(jQuery('#measure-'+id).hasClass('hidden')) {
      jQuery('#measure-'+id).animate(500).removeClass('hidden');
    } else {
      jQuery('#measure-'+id).animate(500).addClass('hidden');
    }
  }
</script>
